services:
  bootnode:
    build: .
    environment:
      ENV: ${ENV}
      FILE_PATH: ${FILE_PATH}
      RPC_URL: ${RPC_URL}
      VALIDATOR: ${VALIDATOR}
      LOG_LEVEL: ${LOG_LEVEL}
      API_ENABLED: ${API_ENABLED}
      USER_AGENTS: ${USER_AGENTS}
    ports:
      - 8081:8080
      - 4001:4001/udp
    volumes:
      - ./.masa-bootnode:/home/masa/.masa
      - ./bootnode.env:/home/masa/.env
    command:
      - --masaDir=/home/masa/.masa
      - --env=${ENV}
      - --api-enabled
      - --logLevel=${LOG_LEVEL}
      - --api-listen-address=0.0.0.0:8080
    restart: always

  worker:
    build: .
    environment:
      BOOTNODES: ${BOOTNODES}
      ENV: ${ENV}
      FILE_PATH: ${FILE_PATH}
      RPC_URL: ${RPC_URL}
      VALIDATOR: ${VALIDATOR}
      LOG_LEVEL: ${LOG_LEVEL}
      API_ENABLED: ${API_ENABLED}
      TWITTER_SCRAPER: ${TWITTER_SCRAPER}
      TWITTER_ACCOUNTS: ${TWITTER_ACCOUNTS}
      USER_AGENTS: ${USER_AGENTS}
    ports:
      - 8082:8080
      - 4002:4001/udp
    volumes:
      - ./.masa-worker:/home/masa/.masa
      - ./worker.env:/home/masa/.env
    command:
      - --masaDir=/home/masa/.masa
      - --env=${ENV}
      - --api-enabled
      - --logLevel=${LOG_LEVEL}
      - --twitterScraper
      - --api-listen-address=0.0.0.0:8080
      - --bootnodes=${BOOTNODES}
    restart: always

# Remove the named volume since we're using bind mounts

